<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">

    <title>Product example for Bootstrap</title>

    <!-- Bootstrap core CSS -->
    <link href="dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="product.css" rel="stylesheet">
  </head>

  <body>

    <div class="position-relative overflow-hidden p-3 p-md-5 m-md-3 text-center bg-light">
      <div class="col-md-5 p-lg-5 mx-auto my-5">
        <h1 class="display-4 font-weight-normal">OneSingleCoin</h1>
        <p class="lead font-weight-normal">A cryptocurrency that has just one single coin in circulation.</p>
        <a class="btn btn-outline-secondary" href="#">Follow on twitter</a>
      </div>
    </div>

    <div class="d-md-flex flex-md-equal w-100 my-md-3 pl-md-3">
      <div class="bg-dark mr-md-3 pt-3 px-3 pt-md-5 px-md-5 text-center text-white overflow-hidden">
        <div class="my-3 py-3">
          <div class="row text-center">
            <div class="col-4">
              <h1>0.12 ETH</h1>
              <div>Current Price</div>
              <div>&asymp; 160$</div>
            </div>

            <div class="col-4">
              <h1>1 coin</h1>
              Total Supply
            </div>

            <div class="col-4">
              <h1>0.12 ETH</h1>
              Market Cap = Price &times; Supply
              <div>&asymp; 160$</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="d-md-flex flex-md-equal w-100 my-md-3 pl-md-3">
      <div class="bg-light mr-md-3 pt-3 px-3 pt-md-5 px-md-5 text-center overflow-hidden">
        <div class="my-3 py-3">
          <h2 class="display-5">The rules</h2>
          <p class="lead">Each time someone buys the OneSingleCoin, its price goes up by 20%.<br/>The seller receives the price minus 8% which gets equally distributed among all the previous owners.</p>
        </div>
      </div>
    </div>

    <div class="d-md-flex flex-md-equal w-100 my-md-3 pl-md-3">
      <div class="bg-primary mr-md-3 pt-3 px-3 pt-md-5 px-md-5 text-center text-white overflow-hidden">
        <div class="my-3 py-3">
          <h2 class="display-5">To the moon</h2>
          <p class="lead">The primary goal of OneSingleCoin is to become a cryptocurrency with the biggest price.<br/>Because fuck you, Bitcoin.</p>
        </div>
      </div>
    </div>

    <div class="d-md-flex flex-md-equal w-100 my-md-3 pl-md-3">
      <div class="bg-light mr-md-3 pt-3 px-3 pt-md-5 px-md-5 text-center overflow-hidden">
        <div class="my-3 py-3">
          <h2 class="display-5">How to buy?</h2>
          <p class="lead">If <a href="https://metamask.io/">Metamask</a> is installed in your browser, these buttons should work:</p>
          <a class="btn btn-outline-secondary" href="#">Buy OneSingleCoin</a>
          <a class="btn btn-outline-secondary" href="#">Withdraw</a>

          <div class="mt-4">You can also interact with <a href="https://etherscan.io/address/0x4b8479e42e1f1a6bf1e600fb750e270f62987905">the coin contract</a> directly from Mist, Parity and other ethereum clients.<br/><a href="https://etherscan.io/address/0x4b8479e42e1f1a6bf1e600fb750e270f62987905" target="_blank">The contract code</a> is verified on etherscan.</div>
        </div>
      </div>
    </div>

    <div class="d-md-flex flex-md-equal w-100 my-md-3 pl-md-3">
      <div class="bg-light mr-md-3 pt-3 px-3 pt-md-5 px-md-5 text-center overflow-hidden">
        <div class="my-3 py-3">
          <h2 class="display-5">The message from the 22th Hodler of OneSinglecoin (should be placed in twitter):</h2>

          <p class="lead">And an even wittier subheading.</p>
        </div>
      </div>
    </div>

    <div class="d-md-flex flex-md-equal w-100 my-md-3 pl-md-3">
      <div class="bg-light mr-md-3 pt-3 px-3 pt-md-5 px-md-5 text-center overflow-hidden">
        <div class="my-3 py-3">
          <h2 class="display-5">What message should i write?</h2>
          <p class="lead">
            It's totally up to you. Any message you write will be immortalized in blockchain.
            <br/>It could be an ad, a <a href="https://www.reddit.com/r/cryptocurrencymemes/" target="_blank">meme</a> or anything else. However we won't publish any abusive/offensive messages here.
            <br/>Choose it wisely. After all, all you will purchase is this message.
          </p>
        </div>
      </div>
    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script>window.jQuery || document.write('<script src="assets/js/vendor/jquery-slim.min.js"><\/script>')</script>
    <script src="assets/js/vendor/popper.min.js"></script>
    <script src="dist/js/bootstrap.min.js"></script>
    <script src="assets/js/vendor/holder.min.js"></script>
    <script>
      Holder.addTheme('thumb', {
        bg: '#55595c',
        fg: '#eceeef',
        text: 'Thumbnail'
      });
    </script>

    <script src="http://rawgit.com/ethereum/web3.js/0.16.0/dist/web3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ethjs@0.3.0/dist/ethjs.min.js"></script>
    <script>
        window.addEventListener('load', function() {
            // Check if Web3 has been injected by the browser:
            if (typeof web3 !== 'undefined') {
                // You have a web3 browser! Continue below!
                startApp(web3);
                //alert("Web3");
            } else {
                //alert("No hay web3");
                // Warn the user that they need to get a web3 browser
                // Or install MetaMask, maybe with a nice graphic.
            }
        })
        const abi = [{
            "constant": false,
            "inputs": [
            ],
            "name": "buy",
            "outputs": [
                {
                    "name": "success",
                    "type": "bool"
                }
            ],
            "payable": true,
            "type": "function"
        }]
        const contract_address = '0xf035755df96ad968a7ad52c968dbe86d52927f5b'
        const etherValue = web3.toWei(10, 'ether');
        var address = '0x91612055A68aD74A6e756615941Ac59e9220A940'
        function startApp(web3) {
            //alert("entro");
            const eth = new Eth(web3.currentProvider)
            const token = eth.contract(abi).at(contract_address);
            listenForClicks(token,web3)
            //alert("llego");
        }
        function listenForClicks (miniToken, web3) {
            var button = document.querySelector('button.transferFunds')
            web3.eth.getAccounts(function(err, accounts) { console.log(accounts); address = accounts.toString(); })
            button.addEventListener('click', function() {
                miniToken.buy( { from: address, value: '1000000000000000000' })
                    .then(function (txHash) {
                        console.log('Transaction sent')
                        console.dir(txHash)
                        waitForTxToBeMined(txHash)
                    })
                    .catch(console.error)
            })
        }
        async function waitForTxToBeMined (txHash) {
            var txReceipt
            while (!txReceipt) {
                try {
                    txReceipt = await eth.getTransactionReceipt(txHash)
                } catch (err) {
                    return indicateFailure(err)
                }
            }
            indicateSuccess()
        }
    </script>
    <button class="transferFunds">Send Money!</button>
  </body>
</html>
